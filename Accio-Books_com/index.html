<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Accio Books! - Your one-stop search tool for all your favorite book sites.">
    <title>Accio Books | One-Stop Search</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/styles.css">

<!-- #region DARK MODE (quick-startup script) -->
    <script>
        // Immediately apply dark mode based on saved preference
        (function() {
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.documentElement.classList.add('dark-mode');
                console.log('Dark mode applied on page load');
            }
        })();
    </script>
<!-- #endregion DARK MODE (quick-startup script) -->

<!-- #region Google Analytics -->
	<!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SBQ15BLV29"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-SBQ15BLV29');
</script>
<!-- #endregion Google Analytics -->
</head>
<body>
    <div class="container">
        <header class="accio-header no-invert">
            <img src="images/accio-books_blue_nospace_1268.png" class="no-invert" alt="Site header titled 'Accio Books!' in a cute font">
        </header>  
<!-- #region ::: LINKED SITES LIST ::: -->
<nav aria-label="Linked Sites">
    <div class="sites-list">
        <span>Goodreads</span><!--
        --><span>Storygraph</span><!--
        --><span>Romance.io</span><!--
        --><span>Amazon Kindle</span><!--
        --><span>Barnes & Noble</span><!--
        --><span>Audible</span><!--
        --><span>Kobo</span><!--
        --><span>Apple</span><!--
        --><span>Google Play</span><!--
        --><span>BookBub</span><!--
        --><span>more coming soon!</span>
    </div>
</nav
<!-- #endregion LINKED SITES LIST -->
         
        <main>
            <section aria-labelledby="intro-text">
                <p id="intro-text">Stop searching, start reading! Accio Books pulls results from all your go-to book sites, so you can find the stories you love quicker.</p>
            </section>
<!-- #endregion INTRO TEXT -->
        
<!-- #region ::: SEARCH FORM AREA ::: -->

            <section aria-labelledby="search-form">
                                <form id="searchForm" aria-labelledby="search-form">
                    <label for="bookTitle">
                        <div class="searchInputWrapper">
                            <input type="text" class="searchInput" id="bookTitle" name="bookTitle" placeholder="Enter Title (author optional) or ISBN" aria-label="Book Title">
                        </div>
                    </label>
                    <div class="search-flexbox">
                        <div class="check-tab">    
                            <input type="checkbox" id="newTabCheckbox" class="check-tab">
                            <label for="newTabCheckbox">Open link in new tab</label>
                        </div>
                        <div class="searchButton">
                            <input type="submit" value="Accio Books!">
                        </div>
                    </div>
                </form>
            </section>
<!-- #endregion SEARCH FORM AREA -->

<!-- #region ::: RESULT HEADER +AFFILIATE INFO ::: -->

<section id="results-container" aria-labelledby="results-header" hidden>
                <h2 id="results-header">Search Results:</h2>
                <p id="results-notes">
                    Amazon links will automatically adapt to your location! <br>
                    Results with "*" are affiliate links. Read more about affiliate links <a href="https:/accio-books.com/faq.html#affiliate-info">here</a>. <br>
                    For Amazon affiliate disclosure, <a href="https:/accio-books.com/faq.html#amazon-disclosure">click here</a>.
                </p>
                <div id="results"></div>
            </section>

            <div id="error" role="alert" style="color: red;"></div>
        </main>

            <!-- #region ::: MAGIC SEARCH LINKS JS SCRIPT ::: -->
        <script>
		// #region ::: AMAZON LOCALIZATON AREA :::
		(function () {
    // Get the user's language from the browser settings
    var userLang = navigator.language || navigator.userLanguage;

    // Define Amazon links for different countries
    var amazonLinks = {
        'US': 'https://www.amazon.com/s?k={searchTerm}&i=digital-text',
        'CA': 'https://www.amazon.ca/s?k={searchTerm}&i=digital-text',
        'GB': 'https://www.amazon.co.uk/s?k={searchTerm}&i=digital-text',
        'DE': 'https://www.amazon.de/s?k={searchTerm}&i=digital-text',
        'FR': 'https://www.amazon.fr/s?k={searchTerm}&i=digital-text',
        'IT': 'https://www.amazon.it/s?k={searchTerm}&i=digital-text',
        'ES': 'https://www.amazon.es/s?k={searchTerm}&i=digital-text',
        'JP': 'https://www.amazon.co.jp/s?k={searchTerm}&i=digital-text',
        'CN': 'https://www.amazon.cn/s?k={searchTerm}&i=digital-text',
        'IN': 'https://www.amazon.in/s?k={searchTerm}&i=digital-text',
        'MX': 'https://www.amazon.com.mx/s?k={searchTerm}&i=digital-text',
        'BR': 'https://www.amazon.com.br/s?k={searchTerm}&i=digital-text',
        'AU': 'https://www.amazon.com.au/s?k={searchTerm}&i=digital-text',
        'NL': 'https://www.amazon.nl/s?k={searchTerm}&i=digital-text',
        'AE': 'https://www.amazon.ae/s?k={searchTerm}&i=digital-text',
        'SA': 'https://www.amazon.sa/s?k={searchTerm}&i=digital-text',
        'SG': 'https://www.amazon.sg/s?k={searchTerm}&i=digital-text',
        'TR': 'https://www.amazon.com.tr/s?k={searchTerm}&i=digital-text',
        'SE': 'https://www.amazon.se/s?k={searchTerm}&i=digital-text',
        'PL': 'https://www.amazon.pl/s?k={searchTerm}&i=digital-text'
    };

    // Function to map user's language to the corresponding Amazon country link
    function getAmazonLink(lang) {
        var langMappings = {
            'en-US': 'US',
            'en-CA': 'CA',
            'en-GB': 'GB',
            'de-DE': 'DE',
            'fr-FR': 'FR',
            'it-IT': 'IT',
            'es-ES': 'ES',
            'ja-JP': 'JP',
            'zh-CN': 'CN',
            'hi-IN': 'IN',
            'es-MX': 'MX',
            'pt-BR': 'BR',
            'en-AU': 'AU',
            'nl-NL': 'NL',
            'ar-AE': 'AE',
            'ar-SA': 'SA',
            'en-SG': 'SG',
            'tr-TR': 'TR',
            'sv-SE': 'SE',
            'pl-PL': 'PL'
        };

        // Return the appropriate Amazon link based on the user's language or default to US if not found
        return amazonLinks[langMappings[lang]] || amazonLinks['US'];
    }

    // Get the Amazon link template for the user's language
    var amazonLinkTemplate = getAmazonLink(userLang);

    // #endregion ::: AMAZON LOCALIZATON AREA :::

    // #region ::: FORM HANDLING SECTION :::

    document.addEventListener("DOMContentLoaded", function() {
        const searchForm = document.getElementById("searchForm");
        const bookTitleInput = document.getElementById("bookTitle");
        const newTabCheckbox = document.getElementById("newTabCheckbox");
        const errorDiv = document.getElementById("error");
        const resultsDiv = document.getElementById("results");
        const resultsHeader = document.getElementById("results-header");

        // Restore previous search and results if available
        const previousSearch = localStorage.getItem("previousSearch");
        const previousResults = localStorage.getItem("previousResults");
        const previousNewTabState = localStorage.getItem("newTabState");

        if (previousSearch) {
            bookTitleInput.value = previousSearch;
        }

        if (previousNewTabState !== null) {
            newTabCheckbox.checked = JSON.parse(previousNewTabState);
        }

        if (previousResults) {
            resultsDiv.innerHTML = previousResults;
            resultsHeader.style.display = 'block';
        }

        searchForm.onsubmit = function(event) {
            event.preventDefault();

            const title = bookTitleInput.value.trim();
            const openInNewTab = newTabCheckbox.checked;

            // Check if the title is empty and show an error message if it is
            if (!title) {
                errorDiv.textContent = "Please enter a book title.";
                resultsDiv.innerHTML = "";
                resultsHeader.style.display = 'none'; // Hide the header note if no title is provided
                return;
            }

            try {
                // Clear any previous error messages
                errorDiv.textContent = "";

                // Define referral codes for Amazon and Barnes & Noble
                const amazonReferralCode = 'acciobooks-20';

                // List of search URLs for different sites
                const searches = [{
                    name: 'Goodreads',
                    url: 'https://www.goodreads.com/search?q={searchTerm}'
                },
                {
                    name: 'StoryGraph',
                    url: 'https://app.thestorygraph.com/browse?search_term={searchTerm}'
                },
                {
                    name: 'Romance.io',
                    url: 'https://www.romance.io/search?q={searchTerm}'
                },
                {
                    name: 'Amazon - Kindle *',
                    url: `https://www.amazon.com/s?k={searchTerm}`,
                    referralUrl: `https://www.amazon.com/s?k={searchTerm}&tag=${amazonReferralCode}`
                },
                {
                    name: 'Barnes & Noble ',
                    url: `https://www.barnesandnoble.com/s/{searchTerm}/_/N-8qa`,
                },
                {
                    name: 'Audible',
                    url: 'https://www.audible.com/search?keywords={searchTerm}'
                },
                {
                    name: 'Kobo eBook *',
                    url: `https://www.kobo.com/us/en/search?query={searchTerm}&fcmedia=Book`,
                    referralUrl: `https://click.linksynergy.com/deeplink?id=Dm1PWoMJswg&mid=37217&murl=https%3a%2f%2fwww.kobo.com%2fus%2fen%2fsearch%3fquery%3d{searchTerm}%26fcmedia%3dBook`
                },
                {
                    name: 'Kobo Audiobook *',
                    url: `https://www.kobo.com/us/en/search?query={searchTerm}&fcmedia=Audiobook`,
                    referralUrl: `https://click.linksynergy.com/deeplink?id=Dm1PWoMJswg&mid=37217&murl=https%3a%2f%2fwww.kobo.com%2fus%2fen%2fsearch%3fquery%3d{searchTerm}%26fcmedia%3dAudiobook`
                },
                {
                    name: 'Apple',
                    url: 'https://www.apple.com/us/search/{searchTerm}?src=globalnav'
                },
                {
                    name: 'Google Play',
                    url: 'https://play.google.com/store/search?c=books&q={searchTerm}'
                },
                {
                    name: 'BookBub',
                    url: 'https://www.bookbub.com/search?search={searchTerm}'
                }
            ];

            // Generate search links for each site
            let searchLinks = searches.map(search => {
                const fullUrl = search.url.replace("{searchTerm}", encodeURIComponent(title));
                let referralLink = search.referralUrl ? search.referralUrl.replace("{searchTerm}", encodeURIComponent(title)) : null;

                let target = openInNewTab ? '_blank' : '_self';

                // Create HTML for links
                // ... create HTML for DUO link results (referral+direct)
                if (referralLink) {
                    return `
                        <div class="result-container--duo">
                            <a href="${referralLink}" target="${target}" class="result-url--referral">${title}</a>
                            <span class="result-details--duo">
                                <span class="result-separator--duo">&ensp;◦&ensp;</span>
                                <span class="result-sitename--duo">${search.name}</span>
                                <a href="${fullUrl}" target="${target}" class="result-url--non-referral">&emsp;non-affiliate link</a>
                            </span>
                        </div>`;
                } else {
                    return `
                        <div class="result-container--mono">
                            <a href="${fullUrl}" target="${target}" class="result-url--mono">${title}</a>
                            <span class="result-details--mono">
                                <span class="result-separator--mono">&ensp;◦&ensp;</span>
                                <span class="result-sitename--mono">${search.name}</span>
                            </span>
                        </div>`;
                }
            }).join('');

            // Display the generated links in the results div
            resultsDiv.innerHTML = searchLinks;
            resultsHeader.style.display = 'block';

            // Save search results and input value to localStorage
            localStorage.setItem("previousSearch", title);
            localStorage.setItem("previousResults", searchLinks);
            localStorage.setItem("newTabState", openInNewTab);

            } catch (error) {
                // Show an error message if something goes wrong
                errorDiv.textContent = "An unexpected error occurred. Please try again.";
                resultsDiv.innerHTML = "";
                resultsHeader.style.display = 'none'; // Hide the header note if an error occurs
                console.error("Error generating search links:", error);
            }
        };
    });
})();
    // #endregion ::: FORM HANDLING SECTION :::
		</script>
		
<!-- #endregion ::: MAGIC SEARCH LINKS JS SCRIPT ::: -->

<!-- #region ::: RAKUTEN AUTOMATE SCRIPT ::: -->
		<script type="text/javascript">
            var _rakuten_automate = {
                u1: "",
                snippetURL: "js/updated_rakuten_script.js",
                automateURL: "https://automate.linksynergy.com",
                widgetKey: "fUtCP86PpnIVe0wJgOLXKnVEvbxSl6Hh",
                aelJS: null,
                useDefaultAEL: false,
                loaded: false,
                events: []
            };
            var ael = window.addEventListener;
            window.addEventListener = function (a, b, c, d) {
                "click" !== a && _rakuten_automate.useDefaultAEL ? ael(a, b, c) : _rakuten_automate.events.push({ type: a, handler: b, capture: c, rakuten: d });
            };
            _rakuten_automate.links = {};
            var httpRequest = new XMLHttpRequest;
            httpRequest.open("GET", _rakuten_automate.snippetURL, !0);
            httpRequest.timeout = 5E3;
            httpRequest.ontimeout = function () {
                if (!_rakuten_automate.loaded) {
                    for (i = 0; i < _rakuten_automate.events.length; i++) {
                        var a = _rakuten_automate.events[i];
                        ael(a.type, a.handler, a.capture);
                    }
                    _rakuten_automate.useDefaultAEL = !0;
                }
            };
            httpRequest.onreadystatechange = function () {
                httpRequest.readyState === XMLHttpRequest.DONE && 200 === httpRequest.status && (eval(httpRequest.responseText), _rakuten_automate.run(ael));
            };
            httpRequest.send(null);
        </script>
<!-- #endregion ::: RAKUTEN AUTOMATE SCRIPT ::: -->

		<footer>
<!-- #region ::: DARK MODE AREA ::: -->
			<div style="margin-top: 10px;"></div>
			<div class="dark-toggle" data-title="Toggle light and dark mode">
				<button id="dark-mode-toggle" aria-label="Toggle light and dark mode">
					<img src="images/darkmode_sun_moon.png" alt="Toggle between light and dark mode" width="42" height="21">
				</button>
			</div>
			<hr>
<!-- #endregion ::: DARK MODE ::: -->
<!-- #region ::: FOOTER TEXT AREA ::: -->
            <p style="line-height: 1.2; font-size: 0.75em; color: #36395A;">
                <span>Hey there! This search tool is a labor of love—I hope you find it helpful! Please <a href="https:/accio-books.com/FAQ.html">click here</a> to
                    learn more about Accio-Books.com's features, including FAQs, fun facts, tips and tricks, affiliate
                    details, and contact info. Thanks and happy reading 📚!
                </span>
            </p>
            <p style="line-height: 1.2; font-size: 0.75em; color: #36395A;">
                <span>- Kacie <a href="mailto:acciobooks.com@gmail.com">(email)</a>&nbsp;
                    Also check out my bookish blog at <a href="https://bluestockingsread.com/">BluestockingsRead.com</a>!
                </span>
            </p>
            <!-- #endregion ::: FOOTER TEXT AREA ::: -->
        </footer>
<!-- #region ::: DARK MODE DOT JS LINK ::: -->
	<script src="js/darkmode.js" defer></script>
<!-- #endregion ::: DARK MODE DOT JS LINK ::: -->
	</div>
</body>
</html>